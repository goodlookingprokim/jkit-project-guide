# 유니버설 시나리오 포맷 스펙

이 문서는 AXYS 시나리오 정의 파일의 표준 포맷을 정의합니다.
모든 `scenarios/*.md` 파일은 이 스펙을 따라야 합니다.

## 파일 구조

각 시나리오 파일은 **YAML frontmatter**와 **마크다운 본문** 두 부분으로 구성됩니다.

```markdown
---
(YAML frontmatter - 메타데이터)
---

(마크다운 본문 - 3단계 워크플로우)
```

## YAML Frontmatter 필수 필드

### `id`
- **타입**: `string`
- **형식**: 영문 kebab-case (소문자, 하이픈 구분)
- **설명**: 시나리오의 고유 식별자. 시스템 전체에서 유일해야 합니다.
- **예시**: `curriculum-planning`, `school-evaluation`, `emergency-response`

### `name_ko`
- **타입**: `string`
- **설명**: 한국어 시나리오명
- **예시**: `교육과정 편성`, `학교 평가`, `위기 대응`

### `lead`
- **타입**: `string`
- **설명**: 시나리오를 주관하는 에이전트의 `id`. `agents/` 디렉토리에 정의된 에이전트여야 합니다.
- **예시**: `head-academic`, `vice-principal`, `admin-director`

### `participants`
- **타입**: `string[]`
- **설명**: 시나리오에 참여하는 에이전트 `id` 목록. `lead`는 포함하지 않습니다 (자동으로 참여자로 간주).
- **예시**: `[principal, vice-principal, head-research, subject-teacher]`

### `phase`
- **타입**: `enum`
- **허용값**: `planning`, `execution`, `evaluation`, `emergency`
- **설명**: 시나리오의 업무 단계
  - `planning`: 기획 및 계획 수립 단계
  - `execution`: 실행 및 운영 단계
  - `evaluation`: 평가 및 검토 단계
  - `emergency`: 긴급 대응 단계

### `estimated_duration`
- **타입**: `string`
- **설명**: 시나리오의 예상 소요 기간
- **예시**: `4주`, `2주`, `1일`, `즉시 대응`

### `outputs`
- **타입**: `string[]`
- **설명**: 시나리오 완료 시 생성되는 산출물 목록
- **예시**: `[교육과정 편성표, 시간표 초안, 교과별 운영 계획]`

### `triggers`
- **타입**: `string[]`
- **설명**: 시나리오가 시작되는 조건 목록. 하나 이상의 조건이 충족되면 시나리오가 활성화됩니다.
- **예시**: `[신학년도 시작 2개월 전, 교육청 지침 변경]`

## 마크다운 본문 필수 구조

모든 시나리오는 3단계(Phase) 구조로 워크플로우를 정의합니다.

### Phase 1: 킥오프

```markdown
## Phase 1: 킥오프
```

시나리오 시작 단계입니다. 다음 내용을 포함합니다:

- **목표 설정**: 시나리오의 달성 목표 명시
- **참여자 확인**: 각 에이전트의 역할 배정
- **일정 수립**: 전체 타임라인과 마일스톤

### Phase 2: 역할별 작업

```markdown
## Phase 2: 역할별 작업
```

각 참여 에이전트가 담당하는 구체적인 업무를 정의합니다. 에이전트별로 하위 섹션을 두어 작업 내용, 산출물, 협업 필요 사항을 기술합니다.

```markdown
### {에이전트 name_ko} ({에이전트 id})
- 담당 업무 1
- 담당 업무 2
- **산출물**: 해당 에이전트가 생성하는 중간 산출물
- **협업**: 다른 에이전트와의 협의/검토 필요 사항
```

### Phase 3: 통합 검증

```markdown
## Phase 3: 통합 검증
```

시나리오 마무리 단계입니다. 다음 내용을 포함합니다:

- **결과 취합**: 각 에이전트의 산출물 수집
- **검토**: 품질 검증 및 피드백
- **최종 승인**: 결재권자의 승인 절차

## 유효성 검사 규칙

1. **id 고유성**: 모든 시나리오의 `id`는 시스템 전체에서 중복되지 않아야 합니다.
2. **lead 참조 유효성**: `lead`에 지정된 `id`는 `agents/` 디렉토리에 실제 존재하는 에이전트여야 합니다.
3. **participants 참조 유효성**: `participants` 목록의 모든 `id`는 실제 존재하는 에이전트여야 합니다.
4. **lead 중복 금지**: `lead`는 `participants` 목록에 포함하지 않습니다.
5. **필수 Phase 존재**: 마크다운 본문에 3개 Phase 섹션이 모두 포함되어야 합니다.
6. **id 형식**: 영문 소문자와 하이픈만 허용됩니다 (`/^[a-z][a-z0-9-]*$/`).
7. **enum 값 범위**: `phase`는 정의된 허용값만 사용 가능합니다.
8. **outputs 비어있지 않음**: 최소 1개의 산출물이 정의되어야 합니다.
9. **triggers 비어있지 않음**: 최소 1개의 시작 조건이 정의되어야 합니다.

## 예시: 교육과정 편성 시나리오 (축약)

```markdown
---
id: curriculum-planning
name_ko: 교육과정 편성
lead: head-academic
participants: [principal, vice-principal, head-research, subject-teacher]
phase: planning
estimated_duration: 4주
outputs: [교육과정 편성표, 시간표 초안, 교과별 운영 계획]
triggers: [신학년도 시작 2개월 전, 교육청 지침 변경]
---

# 교육과정 편성

{{SCHOOL_NAME}}의 학년도 교육과정을 편성하는 시나리오입니다.

## Phase 1: 킥오프

**목표**: 새 학년도 교육과정 편성표 및 시간표 확정

**참여자 역할 배정**:
- 교무부장 (head-academic): 전체 총괄, 편성 기준 수립
- 교장 (principal): 최종 승인
- 교감 (vice-principal): 검토 및 조정
- 연구부장 (head-research): 교육청 지침 분석
- 교과교사 (subject-teacher): 교과별 요구사항 제출

**일정**:
- 1주차: 기초 자료 수집 및 편성 기준 수립
- 2주차: 교과별 시수 배정 및 초안 작성
- 3주차: 검토 및 수정
- 4주차: 최종 확정 및 승인

## Phase 2: 역할별 작업

### 교무부장 (head-academic)
- 전년도 교육과정 운영 결과 분석
- 교육청 편성 지침 반영
- 시간표 초안 작성
- **산출물**: 교육과정 편성 초안, 시간표 초안
- **협업**: 연구부장과 교육청 지침 협의, 교과교사 의견 수렴

### 연구부장 (head-research)
- 교육청 지침 분석 및 정리
- 선진 사례 조사
- **산출물**: 교육청 지침 분석 보고서
- **협업**: 교무부장에게 지침 전달

### 교과교사 (subject-teacher)
- 교과별 필요 시수 산출
- 교과 운영 계획 초안 작성
- **산출물**: 교과별 운영 계획서
- **협업**: 교무부장에게 요구사항 제출

## Phase 3: 통합 검증

**결과 취합**:
- 교무부장이 교과별 운영 계획 취합
- 편성 초안과 시간표 초안 통합

**검토**:
- 교감: 편성 기준 준수 여부 검토
- 교무부장: 시수 배정 적정성 확인

**최종 승인**:
- 교장이 최종 교육과정 편성표 승인
- 승인된 편성표 전 교원 공유
```
